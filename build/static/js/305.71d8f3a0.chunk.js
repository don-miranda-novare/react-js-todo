"use strict";(self.webpackChunkreact_js_todo=self.webpackChunkreact_js_todo||[]).push([[305],{2305:(e,i,s)=>{s.r(i),s.d(i,{Profile:()=>g,default:()=>A});var r=s(8279),o=s(2073),a=s(9208),t=s(784),d=s(899),n=s(4858),l=s(3969),c=s(4842),h=s(2504),m=s(2097),p=s(7536),u=s(6667),x=s(5043),f=s(4250);class v extends f.Ay{constructor(){super("profileDb"),this.profile=void 0,this.version(1).stores({profile:"id, position, email, address"})}}new v;var j=s(579);const g=()=>{const[e]=(0,r.hD)(o.j2),[i,s]=(0,x.useState)({}),[f,g]=(0,x.useState)(!1),[A,y]=(0,x.useState)(""),w=d.Ik().shape({id:d.Yj().optional().default((null===e||void 0===e?void 0:e.uid)||"unknown"),position:d.Yj().required("Position is required").max(20,"Position must be at most 20 characters long"),email:d.Yj().email("Invalid email").required("Email is required").max(20,"Email must be at most 20 characters long"),address:d.Yj().required("Address is required").max(20,"Address must be at most 20 characters long")}),{register:b,handleSubmit:P,formState:{errors:S},reset:k,setValue:D}=(0,n.mN)({resolver:(0,t.t)(w)}),q=(0,u.rJ)(o.eY,"profile"),E=async e=>{const i=new v;i.profile.toArray().then(async s=>{s.length>0?(await i.profile.update(s[0].id,e),y(`Profile updated: ${s[0].id}`)):(await i.profile.add(e),y(`Profile added: ${e.id}`)),g(!0)})};return(0,x.useEffect)(()=>{(async()=>{const e=await(0,u.GG)(q),i={id:e.docs[0].id,position:e.docs[0].data().position,email:e.docs[0].data().email,address:e.docs[0].data().address};s(i)})()},[]),(0,x.useEffect)(()=>{i&&(D("position",null===i||void 0===i?void 0:i.position),D("email",null===i||void 0===i?void 0:i.email),D("address",null===i||void 0===i?void 0:i.address),E(i))},[i]),e?(0,j.jsxs)(l.A,{children:[(0,j.jsx)("h1",{children:"Profile"}),(0,j.jsx)("form",{onSubmit:P(async e=>{if(E(e),"serviceWorker"in navigator&&"SyncManager"in window){const e=await navigator.serviceWorker.ready;await e.sync.register("profile-sync"),console.log("Profile sync registered")}}),children:(0,j.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,j.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,j.jsx)(c.A,{variant:"h6",children:"Position"}),(0,j.jsx)(h.A,{...b("position"),placeholder:"Position",fullWidth:!0,sx:{marginBottom:2},inputProps:{style:{fontSize:"1.25rem"}}})]}),S.position&&(0,j.jsx)(c.A,{variant:"body1",color:"error",children:S.position.message}),(0,j.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,j.jsx)(c.A,{variant:"h6",children:"Email"}),(0,j.jsx)(h.A,{...b("email"),placeholder:"Email",fullWidth:!0,sx:{marginBottom:2},inputProps:{style:{fontSize:"1.25rem"}}})]}),S.email&&(0,j.jsx)(c.A,{variant:"body1",color:"error",children:S.email.message}),(0,j.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,j.jsx)(c.A,{variant:"h6",children:"Address"}),(0,j.jsx)(h.A,{...b("address"),placeholder:"Address",fullWidth:!0,sx:{marginBottom:2},inputProps:{style:{fontSize:"1.25rem"}}})]}),S.address&&(0,j.jsx)(c.A,{variant:"body1",color:"error",children:S.address.message}),(0,j.jsx)(m.A,{type:"submit",variant:"contained",color:"primary",sx:{height:40,borderRadius:2},children:(0,j.jsx)(c.A,{variant:"h6",children:"Save"})})]})}),(0,j.jsx)(p.A,{open:f,autoHideDuration:2e3,onClose:()=>g(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},message:A})]}):(0,j.jsx)(a.c,{})},A=g},9208:(e,i,s)=>{s.d(i,{c:()=>t});var r=s(4842),o=s(2097),a=s(579);const t=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)(r.A,{variant:"h6",children:"You do not have permission to access this page."}),(0,a.jsx)(o.A,{variant:"contained",onClick:()=>window.location.href="/",children:"Back to Home"})]})}}]);
//# sourceMappingURL=305.71d8f3a0.chunk.js.map